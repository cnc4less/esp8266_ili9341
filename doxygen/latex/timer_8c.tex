\hypertarget{timer_8c}{}\section{lib/timer.c File Reference}
\label{timer_8c}\index{lib/timer.\+c@{lib/timer.\+c}}


timer functions  


{\ttfamily \#include $<$stdint.\+h$>$}\\*
{\ttfamily \#include $<$stdarg.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include $<$math.\+h$>$}\\*
{\ttfamily \#include \char`\"{}timer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}time.\+h\char`\"{}}\\*
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{timer_8c_a6c3db6d8efa19f8d102f9a828c8ad6f1}{S\+Y\+S\+T\+E\+M\+\_\+\+HZ}~1000L
\begin{DoxyCompactList}\small\item\em system interrupt rate in HZ \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} int \hyperlink{timer_8c_a35f94fb84f1b626d8d1ace062b26c932}{set\+\_\+timers} (void($\ast$handler)(void), int timer)
\begin{DoxyCompactList}\small\item\em Install a user timer task. \end{DoxyCompactList}\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} int \hyperlink{timer_8c_a71c3fe0e245c7b08e03a2fe0fbd88844}{kill\+\_\+timer} (int timer)
\begin{DoxyCompactList}\small\item\em Delete \char`\"{}\+Kill\char`\"{} one user timer task. \end{DoxyCompactList}\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{timer_8c_a62b37d3b3acfee789af6a9dbd47f7267}{delete\+\_\+all\+\_\+timers} ()
\begin{DoxyCompactList}\small\item\em Clear A\+LL user timer tasks. \end{DoxyCompactList}\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{timer_8c_ab92d687bae984bd62c3d741f2ba614ed}{subtract\+\_\+timespec} (\hyperlink{time_8h_a062a82a85c72b4a3020130efc37a00cf}{ts\+\_\+t} $\ast$a, \hyperlink{time_8h_a062a82a85c72b4a3020130efc37a00cf}{ts\+\_\+t} $\ast$b)
\begin{DoxyCompactList}\small\item\em subtract a-\/= b timespec $\ast$ structures. \end{DoxyCompactList}\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} char $\ast$ \hyperlink{timer_8c_a41fb2edea84c2f17c7c6ad6ff87baeff}{ts\+\_\+to\+\_\+str} (\hyperlink{time_8h_a062a82a85c72b4a3020130efc37a00cf}{ts\+\_\+t} $\ast$val)
\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{timer_8c_a6802af23bc1fe764b975683a0b37fc91}{display\+\_\+ts} (\hyperlink{time_8h_a062a82a85c72b4a3020130efc37a00cf}{ts\+\_\+t} $\ast$val)
\begin{DoxyCompactList}\small\item\em timespec structure in seconds.\+nanoseconds. \end{DoxyCompactList}\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{timer_8c_adf029ed50e104cc3c16bcb7cf7d58f8c}{clock\+\_\+elapsed\+\_\+begin} ()
\begin{DoxyCompactList}\small\item\em Store current struct timespec in \+\_\+\+\_\+clock\+\_\+elapsed. \end{DoxyCompactList}\item 
\hyperlink{earth2wireframe_8c_ad0fe97585b8891f5e4f2b9a6426330a4}{M\+E\+M\+S\+P\+A\+CE} void \hyperlink{timer_8c_a9f3dff4c1cc1701dc99d7e1d30ffcc06}{clock\+\_\+elapsed\+\_\+end} (char $\ast$msg)
\begin{DoxyCompactList}\small\item\em Subtract and display time difference from clock\+\_\+elapesed\+\_\+begin(). \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structTIMERS}{T\+I\+M\+E\+RS} \hyperlink{timer_8c_aa17a38bfa7403efeae5bf6b723ef2888}{timer\+\_\+irq} \mbox{[}$\,$\mbox{]}
\begin{DoxyCompactList}\small\item\em array or user timers \end{DoxyCompactList}\item 
static char \hyperlink{timer_8c_a3b37602023ba3cdbbe1394f43abbef2c}{\+\_\+ts\+\_\+to\+\_\+str} \mbox{[}32\mbox{]}
\begin{DoxyCompactList}\small\item\em timespec structure in seconds.\+nanoseconds in string. \end{DoxyCompactList}\item 
static \hyperlink{time_8h_a062a82a85c72b4a3020130efc37a00cf}{ts\+\_\+t} \hyperlink{timer_8c_a11d81711e20909cf489fb56cbbb81558}{\+\_\+\+\_\+clock\+\_\+elapsed}
\begin{DoxyCompactList}\small\item\em Used for elapsed time calculations. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
timer functions 

\begin{DoxyParagraph}{Copyright \copyright{} 2015 Mike Gore, G\+PL License}

\end{DoxyParagraph}
\begin{DoxyParagraph}{You are free to use this code under the terms of G\+PL}
please retain a copy of this notice in any code you use it in.
\end{DoxyParagraph}
This is free software\+: you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

This software is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR A P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program. If not, see \href{http://www.gnu.org/licenses/}{\tt http\+://www.\+gnu.\+org/licenses/}. 

\subsection{Macro Definition Documentation}
\index{timer.\+c@{timer.\+c}!S\+Y\+S\+T\+E\+M\+\_\+\+HZ@{S\+Y\+S\+T\+E\+M\+\_\+\+HZ}}
\index{S\+Y\+S\+T\+E\+M\+\_\+\+HZ@{S\+Y\+S\+T\+E\+M\+\_\+\+HZ}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{S\+Y\+S\+T\+E\+M\+\_\+\+HZ}{SYSTEM_HZ}}]{\setlength{\rightskip}{0pt plus 5cm}\#define S\+Y\+S\+T\+E\+M\+\_\+\+HZ~1000L}\hypertarget{timer_8c_a6c3db6d8efa19f8d102f9a828c8ad6f1}{}\label{timer_8c_a6c3db6d8efa19f8d102f9a828c8ad6f1}


system interrupt rate in HZ 



Definition at line 31 of file timer.\+c.



\subsection{Function Documentation}
\index{timer.\+c@{timer.\+c}!clock\+\_\+elapsed\+\_\+begin@{clock\+\_\+elapsed\+\_\+begin}}
\index{clock\+\_\+elapsed\+\_\+begin@{clock\+\_\+elapsed\+\_\+begin}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{clock\+\_\+elapsed\+\_\+begin()}{clock_elapsed_begin()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void clock\+\_\+elapsed\+\_\+begin (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_adf029ed50e104cc3c16bcb7cf7d58f8c}{}\label{timer_8c_adf029ed50e104cc3c16bcb7cf7d58f8c}


Store current struct timespec in \+\_\+\+\_\+clock\+\_\+elapsed. 

\begin{DoxySeeAlso}{See also}
\hyperlink{timer__hal_8c_aa6e5b6a9c1fb8bc6e2093fca40600bf5}{clock\+\_\+gettime()} \hyperlink{posix_8h_a1c3d85ae80df5590fa314acffd8bf840}{P\+O\+S\+IX} function.
\end{DoxySeeAlso}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 173 of file timer.\+c.

\index{timer.\+c@{timer.\+c}!clock\+\_\+elapsed\+\_\+end@{clock\+\_\+elapsed\+\_\+end}}
\index{clock\+\_\+elapsed\+\_\+end@{clock\+\_\+elapsed\+\_\+end}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{clock\+\_\+elapsed\+\_\+end(char $\ast$msg)}{clock_elapsed_end(char *msg)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void clock\+\_\+elapsed\+\_\+end (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{msg}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_a9f3dff4c1cc1701dc99d7e1d30ffcc06}{}\label{timer_8c_a9f3dff4c1cc1701dc99d7e1d30ffcc06}


Subtract and display time difference from clock\+\_\+elapesed\+\_\+begin(). 


\begin{DoxyItemize}
\item Notes\+: Accuracy is a function of timer resolution, C\+PU overhead and background tasks.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em msg} & User message to proceed Time display.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}
\begin{DoxySeeAlso}{See also}
\hyperlink{timer__hal_8c_aa6e5b6a9c1fb8bc6e2093fca40600bf5}{clock\+\_\+gettime()}. 

clock\+\_\+elapesed\+\_\+begin(). 
\end{DoxySeeAlso}


Definition at line 189 of file timer.\+c.

\index{timer.\+c@{timer.\+c}!delete\+\_\+all\+\_\+timers@{delete\+\_\+all\+\_\+timers}}
\index{delete\+\_\+all\+\_\+timers@{delete\+\_\+all\+\_\+timers}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{delete\+\_\+all\+\_\+timers()}{delete_all_timers()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void delete\+\_\+all\+\_\+timers (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_a62b37d3b3acfee789af6a9dbd47f7267}{}\label{timer_8c_a62b37d3b3acfee789af6a9dbd47f7267}


Clear A\+LL user timer tasks. 

\begin{DoxyReturn}{Returns}
void 
\end{DoxyReturn}


Definition at line 106 of file timer.\+c.



Referenced by init\+\_\+timers().

\index{timer.\+c@{timer.\+c}!display\+\_\+ts@{display\+\_\+ts}}
\index{display\+\_\+ts@{display\+\_\+ts}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{display\+\_\+ts(ts\+\_\+t $\ast$val)}{display_ts(ts_t *val)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void display\+\_\+ts (
\begin{DoxyParamCaption}
\item[{{\bf ts\+\_\+t} $\ast$}]{val}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_a6802af23bc1fe764b975683a0b37fc91}{}\label{timer_8c_a6802af23bc1fe764b975683a0b37fc91}


timespec structure in seconds.\+nanoseconds. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em val} & timespec struct we want to display.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 156 of file timer.\+c.

\index{timer.\+c@{timer.\+c}!kill\+\_\+timer@{kill\+\_\+timer}}
\index{kill\+\_\+timer@{kill\+\_\+timer}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{kill\+\_\+timer(int timer)}{kill_timer(int timer)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} int kill\+\_\+timer (
\begin{DoxyParamCaption}
\item[{int}]{timer}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_a71c3fe0e245c7b08e03a2fe0fbd88844}{}\label{timer_8c_a71c3fe0e245c7b08e03a2fe0fbd88844}


Delete \char`\"{}\+Kill\char`\"{} one user timer task. 


\begin{DoxyItemize}
\item \char`\"{}kill\char`\"{} is a common Linux term for ending a process.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em timer} & user timer task index.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
timer on success. 

-\/1 on error. 
\end{DoxyReturn}


Definition at line 89 of file timer.\+c.

\index{timer.\+c@{timer.\+c}!set\+\_\+timers@{set\+\_\+timers}}
\index{set\+\_\+timers@{set\+\_\+timers}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{set\+\_\+timers(void($\ast$handler)(void), int timer)}{set_timers(void(*handler)(void), int timer)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} int set\+\_\+timers (
\begin{DoxyParamCaption}
\item[{void($\ast$)(void)}]{handler, }
\item[{int}]{timer}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_a35f94fb84f1b626d8d1ace062b26c932}{}\label{timer_8c_a35f94fb84f1b626d8d1ace062b26c932}


Install a user timer task. 


\begin{DoxyItemize}
\item timer argument is unsused, reserved for timer source.
\end{DoxyItemize}


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em handler)} & function pointer to user task. \\
\hline
\mbox{\tt in}  & {\em timer} & reserved for systems with additional low level hardware timers.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
timer on success. 

-\/1 on error. 
\end{DoxyReturn}


Definition at line 49 of file timer.\+c.



Referenced by clock\+\_\+init(), init\+\_\+timers(), mmc\+\_\+install\+\_\+timer(), and ms\+\_\+init().

\index{timer.\+c@{timer.\+c}!subtract\+\_\+timespec@{subtract\+\_\+timespec}}
\index{subtract\+\_\+timespec@{subtract\+\_\+timespec}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{subtract\+\_\+timespec(ts\+\_\+t $\ast$a, ts\+\_\+t $\ast$b)}{subtract_timespec(ts_t *a, ts_t *b)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} void subtract\+\_\+timespec (
\begin{DoxyParamCaption}
\item[{{\bf ts\+\_\+t} $\ast$}]{a, }
\item[{{\bf ts\+\_\+t} $\ast$}]{b}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_ab92d687bae984bd62c3d741f2ba614ed}{}\label{timer_8c_ab92d687bae984bd62c3d741f2ba614ed}


subtract a-\/= b timespec $\ast$ structures. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em a} & timespec struct. \\
\hline
\mbox{\tt in}  & {\em b} & timespec struct.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 124 of file timer.\+c.



Referenced by clock\+\_\+elapsed\+\_\+end().

\index{timer.\+c@{timer.\+c}!ts\+\_\+to\+\_\+str@{ts\+\_\+to\+\_\+str}}
\index{ts\+\_\+to\+\_\+str@{ts\+\_\+to\+\_\+str}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{ts\+\_\+to\+\_\+str(ts\+\_\+t $\ast$val)}{ts_to_str(ts_t *val)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+E\+M\+S\+P\+A\+CE} char$\ast$ ts\+\_\+to\+\_\+str (
\begin{DoxyParamCaption}
\item[{{\bf ts\+\_\+t} $\ast$}]{val}
\end{DoxyParamCaption}
)}\hypertarget{timer_8c_a41fb2edea84c2f17c7c6ad6ff87baeff}{}\label{timer_8c_a41fb2edea84c2f17c7c6ad6ff87baeff}


Definition at line 144 of file timer.\+c.



Referenced by clock\+\_\+elapsed\+\_\+end(), and display\+\_\+ts().



\subsection{Variable Documentation}
\index{timer.\+c@{timer.\+c}!\+\_\+\+\_\+clock\+\_\+elapsed@{\+\_\+\+\_\+clock\+\_\+elapsed}}
\index{\+\_\+\+\_\+clock\+\_\+elapsed@{\+\_\+\+\_\+clock\+\_\+elapsed}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+\+\_\+clock\+\_\+elapsed}{__clock_elapsed}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ts\+\_\+t} \+\_\+\+\_\+clock\+\_\+elapsed\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{timer_8c_a11d81711e20909cf489fb56cbbb81558}{}\label{timer_8c_a11d81711e20909cf489fb56cbbb81558}


Used for elapsed time calculations. 

\begin{DoxySeeAlso}{See also}
\hyperlink{timer_8c_adf029ed50e104cc3c16bcb7cf7d58f8c}{clock\+\_\+elapsed\+\_\+begin()}. 

\hyperlink{timer_8c_a9f3dff4c1cc1701dc99d7e1d30ffcc06}{clock\+\_\+elapsed\+\_\+end()}. 
\end{DoxySeeAlso}


Definition at line 165 of file timer.\+c.

\index{timer.\+c@{timer.\+c}!\+\_\+ts\+\_\+to\+\_\+str@{\+\_\+ts\+\_\+to\+\_\+str}}
\index{\+\_\+ts\+\_\+to\+\_\+str@{\+\_\+ts\+\_\+to\+\_\+str}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{\+\_\+ts\+\_\+to\+\_\+str}{_ts_to_str}}]{\setlength{\rightskip}{0pt plus 5cm}char \+\_\+ts\+\_\+to\+\_\+str\mbox{[}32\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{timer_8c_a3b37602023ba3cdbbe1394f43abbef2c}{}\label{timer_8c_a3b37602023ba3cdbbe1394f43abbef2c}


timespec structure in seconds.\+nanoseconds in string. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em } & timespec struct we wish to display. \\
\hline
\mbox{\tt in}  & {\em } & output string.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
void. 
\end{DoxyReturn}


Definition at line 142 of file timer.\+c.

\index{timer.\+c@{timer.\+c}!timer\+\_\+irq@{timer\+\_\+irq}}
\index{timer\+\_\+irq@{timer\+\_\+irq}!timer.\+c@{timer.\+c}}
\subsubsection[{\texorpdfstring{timer\+\_\+irq}{timer_irq}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf T\+I\+M\+E\+RS} timer\+\_\+irq\mbox{[}$\,$\mbox{]}}\hypertarget{timer_8c_aa17a38bfa7403efeae5bf6b723ef2888}{}\label{timer_8c_aa17a38bfa7403efeae5bf6b723ef2888}


array or user timers 



Definition at line 44 of file timer\+\_\+hal.\+c.

